tic


fid = fopen('BCHF102pairsRecode2.ped');
%genotype_fileID = fopen('diplotypes.bin','a','n','US-ASCII');

line_ex = fgetl(fid);
col_elements = strsplit(line_ex);
%metadata(1,:) =  col_elements(1,1:6);


 
% There  are 6 columns with metadata at the begining
% Some number, animal id, ,some number ,some number, sex, and pair id?
% diplotype pairs start at column 7

% convert diplotypes to singe charachter representation 
%
% rules:
%       A = A,A
%       C = C,C
%       G = G,G
%       T = T,T
%       R = A,G or G,A
%       Y = C,T or T,C
%       S = C,G or G,C
%       W = A,T or T,A
%       K = G,T or T,G
%       M = A,C or C,A

% run through the pairs, one pair at a time

%col_elements = strsplit(line_ex);
%total_num_cols = length(col_elements);
%genotype_cols(1,:) = col_elements(1,7:total_num_cols);
%total_num_geno = length(genotype_cols);

code_pair  = char();
codepair_array = char(); 
metadata_array = char();
% col_idx = int32(1:2:total_num_geno-1);


keySet = {'AA','CC','GG','TT','AG','GA','CT','TC','CG','GC','AT','TA','GT','TG','AC','CA','00'};
valueSet = {'A','C','G','T','R','R','Y','Y','S','S','W','W','K','K','M','M','N'};
diplo = containers.Map(keySet,valueSet);


while ischar (line_ex)
    
    col_elements = strsplit(line_ex);
    total_num_cols = length(col_elements);
    metadata(1,:) =  col_elements(1,1:6);
       
    genotype_cols(1,:) = col_elements(1,7:total_num_cols);
    
    for i = 1:2:total_num_geno-1      
        pair = strcat(genotype_cols(i),genotype_cols(i+1));       
        code_pair(ndx(i)) = diplo(string(pair));                
    end
    
    codepair_array = cat(1, codepair_array, code_pair);
    line_ex = fgetl(fid);    
end

toc


function y = ndx(i)
y = int32((i+1)/2);
end


%         if  pair == "AA"
%             code_pair(ndx(i)) = "A";
%         elseif pair == "CC"
%             code_pair(ndx(i)) = "C";
%         elseif pair == "GG"
%             code_pair(ndx(i)) = "G";
%         elseif pair == "TT"
%             code_pair(ndx(i)) = "T";
%         elseif pair == "AG" || pair == "GA"
%             code_pair(ndx(i)) = "R";
%         elseif pair == "CT" || pair == "TC"
%             code_pair(ndx(i)) = "Y";
%         elseif pair == "CG" || pair == "GC"
%             code_pair(ndx(i)) = "S";
%         elseif pair == "AT" || pair == "TA"
%             code_pair(ndx(i)) = "W";
%         elseif pair == "GT" || pair == "TG"
%             code_pair(ndx(i))= "K";
%         elseif pair == "AC" || pair == "CA"
%             code_pair(ndx(i)) = "M";
%         elseif pair == "00"
%             code_pair(ndx(i)) = "N";
%         end